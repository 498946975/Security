### 1、文件上传的目录设置为不可执行
只要web容器无法解析该目录下面的文件，即使攻击者上传了脚本文件，服务器本身也不会受到影响。

### 2、判断文件类型
在判断文件类型时，可以结合使用·MIME Type、后缀检查等方式。
在文件类型检查中，强烈推荐白名单方式，黑名单的方式已经无数次被证明是不可靠的。
此外，对于图片的处理，可以使用压缩函数或者resize函数，在处理图片的同时破坏图片中可能包含的HTML代码。

### 3、使用随机数改写文件名和文件路径
文件上传如果要执行代码，则需要用户能够访问到这个文件。
在某些环境中，用户能上传，但不能访问。如果应用了随机数改写了文件名和路径，将极大地增加攻击的成本。
再来就是像shell.php.rar.rar和 crossdomain.xml这种文件，都将因为重命名而无法攻击。

### 4、使用安全设备防御
文件上传攻击的本质就是将恶意文件或者脚本上传到服务器，
专业的安全设备防御此类漏洞主要是通过对漏洞的上传利用行为和恶意文件的上传过程进行检测。
恶意文件千变万化，隐藏手法也不断推陈出新，对普通的系 统管理员来说可以通过部署安全设备来帮助防御。